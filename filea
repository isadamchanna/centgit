This is from vm2 second code
